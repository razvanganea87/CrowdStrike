from dataclasses import dataclass, field
from typing import List, Optional
from datetime import datetime

from models.component import Component
from models.remediation import Remediation
from models.cvss import CVSS


@dataclass
class ZafranVulnerability:
    instance_id: str
    cve: str
    in_runtime: bool = False
    component: Optional[Component] = None
    remediation: Optional[Remediation] = None
    cvss_list: List[CVSS] = field(default_factory=list)
    cwe_ids: List[int] = field(default_factory=list)
    description: Optional[str] = None
    first_observed: Optional[datetime] = None
    last_observed: Optional[datetime] = None
    file_paths: List[str] = field(default_factory=list)
    scanner_id: Optional[str] = None
    external_url: Optional[str] = None
    references_url: Optional[str] = None
    scanner_name: Optional[str] = None
    severity: Optional[str] = None
